!function(){function e(e){if(!e)return"";var r=Object.keys(e).map(function(r){return encodeURIComponent(r)+"="+encodeURIComponent(e[r])}).join("&");return r?"?"+r:""}function r(e,r){return Object.prototype.toString.call(e).replace(/\[object\s(\w+)\]/,"$1")===r}function t(){var e=Array.prototype.slice.call(arguments);return Object.assign.apply(Object,[{}].concat(e))}function n(e){var r="",t=!1;try{r=JSON.parse(e)}catch(n){r=e,t=!0}return{data:r,err:t}}function o(t){var n=t.method.toUpperCase(),o=t.baseUrl,a=t.url,s=t.params;return a=o?o+"/"+a:a,t.url=a,t.method=n,"GET"===n?(t.url=a+e(s),void(t.params=null)):void(r(s,"Object")&&(t.params=JSON.stringify(s)))}function a(e){o(e);var r=e.method,t=e.params,n=e.url,a=e.timeout,s=e.onsuccess,u=e.onerror,i=e.ontimeout,c=new XMLHttpRequest;c.withCredentials=!0,c.timeout=a,c.open(r,n),c.onload=function(){c.status>=200&&c.status<300||304===c.status?s(c):u(c)},a&&i&&(c.ontimeout=function(){i(c)}),c.onerror=u,c.send(t)}function s(e,r){return r=r||{},{msg:e,status:r.status,timeout:r.timeout,statusText:r.statusText,responseURL:r.responseURL,responseText:r.responseText,info:n(r.responseText).data}}function f(e,r){var n=t(c,e),o=t(i,r),s=o.errorHandler,u=o.successHandler,f=o.timeoutHandler;return function(e){var r=t(n,e);return new Promise(function(e,n){var o=t(r,{onsuccess:function(r){u(r,e,n)},onerror:function(e){s(e,n)},ontimeout:function(e){f(e,n)}});a(o)})}}var u={PARSE:"数据解析出错",REQUEST:"请求出错",TIMEOUT:"请求超时"},i={successHandler:function(e,r,t){var o=n(e.responseText);return o.err?void t(s(u.PARSE,e)):void r(o.data)},errorHandler:function(e,r){r(s(u.REQUEST,e))},timeoutHandler:function(e,r){r(s(u.TIMEOUT,e))}},c={baseUrl:"",timeout:0,method:"get"};f.util={parse:n,isType:r,merge:t,fetcher:a,serialize:e,buildErrInfo:s},"object"==typeof exports?module.exports=f:window.Ereq=f}();