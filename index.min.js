!function(){function e(e){if(!e)return"";var t=Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&");return t?"?"+t:""}function t(e,t){return Object.prototype.toString.call(e).replace(/\[object\s(\w+)\]/,"$1")===t}function r(){var e=Array.prototype.slice.call(arguments);return Object.assign.apply(Object,[{}].concat(e))}function n(r){var n=r.method.toUpperCase(),o=r.baseUrl,a=r.url,s=r.params;return a=o?o+"/"+a:a,r.url=a,r.method=n,"GET"===n?(r.url=a+e(s),void(r.params=null)):void(t(s,"Object")&&(r.params=JSON.stringify(s)))}function o(e){n(e);var t=e.method,r=e.params,o=e.url,a=e.timeout,s=e.onsuccess,u=e.onerror,i=e.ontimeout,c=new XMLHttpRequest;c.withCredentials=!0,c.timeout=a,c.open(t,o),c.onload=function(){c.status>=200&&c.status<300||304===c.status?s(c):u(c)},a&&i&&(c.ontimeout=function(){i(c)}),c.onerror=u,c.send(r)}function a(e,t){return t=t||{},{msg:e,status:t.status,timeout:t.timeout,statusText:t.statusText,responseURL:t.responseURL,responseText:t.responseText}}function c(e,t){var n=r(i,e),a=r(u,t),s=a.errorHandler,c=a.successHandler,l=a.timeoutHandler;return function(e){var t=r(n,e);return new Promise(function(e,n){var a=r(t,{onsuccess:function(t){c(t,e,n)},onerror:function(e){s(e,n)},ontimeout:function(e){l(e,n)}});o(a)})}}var s={PARSE:"数据解析出错",REQUEST:"请求出错",TIMEOUT:"请求超时"},u={successHandler:function(e,t,r){var n=null;try{n=JSON.parse(e.responseText)}catch(o){return void r(a(s.PARSE,e))}t(n)},errorHandler:function(e,t){t(a(s.REQUEST,e))},timeoutHandler:function(e,t){t(a(s.TIMEOUT,e))}},i={baseUrl:"",timeout:0,method:"get"};c.util={isType:t,merge:r,fetcher:o,serialize:e,buildErrInfo:a},"object"==typeof exports?module.exports=c:window.Ereq=c}();